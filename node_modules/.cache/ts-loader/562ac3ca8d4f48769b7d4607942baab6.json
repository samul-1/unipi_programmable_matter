{"remainingRequest":"/home/samuele/Desktop/vue/programmable_matter/node_modules/babel-loader/lib/index.js!/home/samuele/Desktop/vue/programmable_matter/node_modules/ts-loader/index.js??ref--15-2!/home/samuele/Desktop/vue/programmable_matter/node_modules/eslint-loader/index.js??ref--14-0!/home/samuele/Desktop/vue/programmable_matter/src/scheduler.ts","dependencies":[{"path":"/home/samuele/Desktop/vue/programmable_matter/src/scheduler.ts","mtime":1644315082966},{"path":"/home/samuele/Desktop/vue/programmable_matter/babel.config.js","mtime":1643707685170},{"path":"/home/samuele/Desktop/vue/programmable_matter/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/samuele/Desktop/vue/programmable_matter/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/samuele/Desktop/vue/programmable_matter/node_modules/ts-loader/index.js","mtime":499162500000},{"path":"/home/samuele/Desktop/vue/programmable_matter/node_modules/eslint-loader/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:dmFyIF90aGlzID0gdGhpczsKCmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi50aW1lcnMuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5mb3ItZWFjaC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZXZlcnkuanMiOwppbXBvcnQgc3RvcmUgZnJvbSAnLi9zdG9yZSc7CmltcG9ydCB7IHNhbXBsZVNpemUgfSBmcm9tICdsb2Rhc2gnOwp2YXIgREVMQVkgPSAxMDA7Cgp2YXIgZ2V0QWN0aXZlUGFydGljbGVzID0gZnVuY3Rpb24gZ2V0QWN0aXZlUGFydGljbGVzKCkgewogIHJldHVybiBzYW1wbGVTaXplKHN0b3JlLnN0YXRlLnBhcnRpY2xlcywgTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogKHN0b3JlLnN0YXRlLnBhcnRpY2xlcy5sZW5ndGggLSAxKSArIDEpKTsKfTsKCnZhciBnZXROZXh0VGFyZ2V0ID0gZnVuY3Rpb24gZ2V0TmV4dFRhcmdldChwYXJ0aWNsZSkgewogIHZhciBwYXJ0aWNsZVBvaW50ID0gc3RvcmUuZ2V0dGVycy5nZXRQb2ludChwYXJ0aWNsZS5jdXJyZW50Um93LCBwYXJ0aWNsZS5jdXJyZW50Q29sKTsKICB2YXIgZnJlZU5laWdoYm9ySW50ZXJ2YWwgPSBzdG9yZS5nZXR0ZXJzLmdldEZyZWVOZWlnaGJvcnNJbnRlcnZhbChwYXJ0aWNsZVBvaW50KTsKCiAgaWYgKGZyZWVOZWlnaGJvckludGVydmFsLmxlbmd0aCA+IDIgJiYgZnJlZU5laWdoYm9ySW50ZXJ2YWwubGVuZ3RoIDwgNikgewogICAgdmFyIHRhcmdldEluZGV4ID0gTWF0aC5mbG9vcihmcmVlTmVpZ2hib3JJbnRlcnZhbC5sZW5ndGggLyAyKTsKICAgIHJldHVybiBmcmVlTmVpZ2hib3JJbnRlcnZhbFt0YXJnZXRJbmRleF07CiAgfQoKICByZXR1cm4gbnVsbDsKfTsKCnZhciBtYWtlTW92ZSA9IGZ1bmN0aW9uIG1ha2VNb3ZlKHBhcnRpY2xlKSB7CiAgdmFyIHRhcmdldCA9IHN0b3JlLmdldHRlcnMuZ2V0UGFydGljbGVUYXJnZXQocGFydGljbGUuaWQpOwoKICBpZiAodGFyZ2V0ICYmIHN0b3JlLmdldHRlcnMuaXNHcmlkUG9pbnRGcmVlKHRhcmdldCkpIHsKICAgIHN0b3JlLmNvbW1pdCgnbW92ZVBhcnRpY2xlVG9UYXJnZXQnLCB7CiAgICAgIGlkOiBwYXJ0aWNsZS5pZAogICAgfSk7CiAgfSBlbHNlIHsKICAgIHZhciBfdGFyZ2V0ID0gZ2V0TmV4dFRhcmdldChwYXJ0aWNsZSk7CgogICAgaWYgKF90YXJnZXQpIHsKICAgICAgc3RvcmUuY29tbWl0KCd1cGRhdGVQYXJ0aWNsZVRhcmdldCcsIHsKICAgICAgICBpZDogcGFydGljbGUuaWQsCiAgICAgICAgdGFyZ2V0OiBfdGFyZ2V0CiAgICAgIH0pOwogICAgfQogIH0KfTsKCmV4cG9ydCB2YXIgcnVuID0gZnVuY3Rpb24gcnVuKCkgewogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zdGFudC1jb25kaXRpb24KICBzZXRJbnRlcnZhbChmdW5jdGlvbiAoKSB7CiAgICB2YXIgYWN0aXZlUGFydGljbGVzID0gZ2V0QWN0aXZlUGFydGljbGVzKCk7CiAgICBhY3RpdmVQYXJ0aWNsZXMuZm9yRWFjaChmdW5jdGlvbiAocCkgewogICAgICByZXR1cm4gbWFrZU1vdmUocCk7CiAgICB9KTsKCiAgICBpZiAoc3RvcmUuc3RhdGUucGFydGljbGVzLmV2ZXJ5KGZ1bmN0aW9uIChwKSB7CiAgICAgIHN0b3JlLmdldHRlcnMuZ2V0UG9pbnQoX3RoaXMucGFydGljbGUuY3VycmVudFJvdywgX3RoaXMucGFydGljbGUuY3VycmVudENvbCk7CiAgICB9KSkgewogICAgICB3aW5kb3cuYWxlcnQoJ1Jpc29sdG8hJyk7CiAgICB9CiAgfSwgREVMQVkpOwp9Ow=="},{"version":3,"sources":["/home/samuele/Desktop/vue/programmable_matter/node_modules/eslint-loader/index.js??ref--14-0!/home/samuele/Desktop/vue/programmable_matter/src/scheduler.ts"],"names":[],"mappings":";;;;;;;AACA,OAAO,KAAP,MAAkB,SAAlB;AACA,SAAS,UAAT,QAA2B,QAA3B;AAEA,IAAM,KAAK,GAAG,GAAd;;AAEA,IAAM,kBAAkB,GAAG,SAArB,kBAAqB;AAAA,SACzB,UAAU,CACR,KAAK,CAAC,KAAN,CAAY,SADJ,EAER,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,MAAL,MAAiB,KAAK,CAAC,KAAN,CAAY,SAAZ,CAAsB,MAAtB,GAA+B,CAAhD,IAAqD,CAAhE,CAFQ,CADe;AAAA,CAA3B;;AAMA,IAAM,aAAa,GAAG,SAAhB,aAAgB,CAAC,QAAD,EAA0C;AAC9D,MAAM,aAAa,GAAG,KAAK,CAAC,OAAN,CAAc,QAAd,CACpB,QAAQ,CAAC,UADW,EAEpB,QAAQ,CAAC,UAFW,CAAtB;AAIA,MAAM,oBAAoB,GAAG,KAAK,CAAC,OAAN,CAAc,wBAAd,CAC3B,aAD2B,CAA7B;;AAIA,MACE,oBAAoB,CAAC,MAArB,GAA8B,CAA9B,IACA,oBAAoB,CAAC,MAArB,GAA8B,CAFhC,EAGE;AACA,QAAM,WAAW,GAAG,IAAI,CAAC,KAAL,CAAW,oBAAoB,CAAC,MAArB,GAA8B,CAAzC,CAApB;AACA,WAAO,oBAAoB,CAAC,WAAD,CAA3B;AACD;;AAED,SAAO,IAAP;AACD,CAlBD;;AAoBA,IAAM,QAAQ,GAAG,SAAX,QAAW,CAAC,QAAD,EAA8B;AAC7C,MAAM,MAAM,GAAG,KAAK,CAAC,OAAN,CAAc,iBAAd,CAAgC,QAAQ,CAAC,EAAzC,CAAf;;AACA,MAAI,MAAM,IAAI,KAAK,CAAC,OAAN,CAAc,eAAd,CAA8B,MAA9B,CAAd,EAAqD;AACnD,IAAA,KAAK,CAAC,MAAN,CAAa,sBAAb,EAAqC;AACnC,MAAA,EAAE,EAAE,QAAQ,CAAC;AADsB,KAArC;AAGD,GAJD,MAIO;AACL,QAAM,OAAM,GAAG,aAAa,CAAC,QAAD,CAA5B;;AACA,QAAI,OAAJ,EAAY;AACV,MAAA,KAAK,CAAC,MAAN,CAAa,sBAAb,EAAqC;AACnC,QAAA,EAAE,EAAE,QAAQ,CAAC,EADsB;AAEnC,QAAA,MAAM,EAAN;AAFmC,OAArC;AAID;AACF;AACF,CAfD;;AAiBA,OAAO,IAAM,GAAG,GAAG,SAAN,GAAM,GAAW;AAC5B;AACA,EAAA,WAAW,CAAC,YAAK;AACf,QAAM,eAAe,GAAG,kBAAkB,EAA1C;AAEA,IAAA,eAAe,CAAC,OAAhB,CAAwB,UAAC,CAAD;AAAA,aAAO,QAAQ,CAAC,CAAD,CAAf;AAAA,KAAxB;;AAEA,QACE,KAAK,CAAC,KAAN,CAAY,SAAZ,CAAsB,KAAtB,CAA4B,UAAC,CAAD,EAAM;AAChC,MAAA,KAAK,CAAC,OAAN,CAAc,QAAd,CACE,KAAI,CAAC,QAAL,CAAc,UADhB,EAEE,KAAI,CAAC,QAAL,CAAc,UAFhB;AAID,KALD,CADF,EAOE;AACA,MAAA,MAAM,CAAC,KAAP,CAAa,UAAb;AACD;AACF,GAfU,EAeR,KAfQ,CAAX;AAgBD,CAlBM","sourcesContent":["import { GridPoint, IParticle } from './interfaces';\nimport store from './store';\nimport { sampleSize } from 'lodash';\n\nconst DELAY = 100;\n\nconst getActiveParticles = (): IParticle[] =>\n  sampleSize(\n    store.state.particles,\n    Math.floor(Math.random() * (store.state.particles.length - 1) + 1)\n  );\n\nconst getNextTarget = (particle: IParticle): GridPoint | null => {\n  const particlePoint = store.getters.getPoint(\n    particle.currentRow,\n    particle.currentCol\n  );\n  const freeNeighborInterval = store.getters.getFreeNeighborsInterval(\n    particlePoint\n  ) as GridPoint[];\n\n  if (\n    freeNeighborInterval.length > 2 &&\n    freeNeighborInterval.length < 6\n  ) {\n    const targetIndex = Math.floor(freeNeighborInterval.length / 2);\n    return freeNeighborInterval[targetIndex];\n  }\n\n  return null;\n};\n\nconst makeMove = (particle: IParticle): void => {\n  const target = store.getters.getParticleTarget(particle.id);\n  if (target && store.getters.isGridPointFree(target)) {\n    store.commit('moveParticleToTarget', {\n      id: particle.id,\n    });\n  } else {\n    const target = getNextTarget(particle);\n    if (target) {\n      store.commit('updateParticleTarget', {\n        id: particle.id,\n        target,\n      });\n    }\n  }\n};\n\nexport const run = (): void => {\n  // eslint-disable-next-line no-constant-condition\n  setInterval(() => {\n    const activeParticles = getActiveParticles();\n\n    activeParticles.forEach((p) => makeMove(p));\n\n    if (\n      store.state.particles.every((p) => {\n        store.getters.getPoint(\n          this.particle.currentRow,\n          this.particle.currentCol\n        );\n      })\n    ) {\n      window.alert('Risolto!');\n    }\n  }, DELAY);\n};\n"],"sourceRoot":""}]}